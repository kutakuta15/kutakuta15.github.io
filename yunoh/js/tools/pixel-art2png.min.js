document.getElementById("imageInput").addEventListener("change",function(e){let file=e.target.files[0];if(file){let img=new Image;img.onload=()=>{var width=img.width,height=img.height,canvas=document.createElement("canvas"),canvas=(canvas.width=width,canvas.height=height,canvas.getContext("2d")),imageData=(canvas.drawImage(img,0,0),canvas.getImageData(0,0,width,height).data);let svg=`<svg version="1.0" xmlns="http://www.w3.org/2000/svg"
 width="${width}" height="${height}" viewBox="0 0 ${width} ${height}">`;for(let y=0;y<height;y++){let x=0;for(;x<width;){var i=4*(y*width+x),color=`rgb(${imageData[i]},${imageData[1+i]},${imageData[2+i]})`;let runLength=1;for(;x+runLength<width;){var j=4*(y*width+x+runLength);if(`rgb(${imageData[j]},${imageData[1+j]},${imageData[2+j]})`!=color)break;runLength++}svg+=`<rect x="${x}" y="${y}" width="${runLength}" height="1" fill="${color}"/>`,x+=runLength}}svg+="</svg>",document.getElementById("svgDisplay").innerHTML=svg,document.getElementById("svgOutput").value=svg;let fileName=file.name;fileName=fileName.substr(0,fileName.lastIndexOf("."));canvas=document.createElement("a");canvas.href=window.URL.createObjectURL(new Blob([svg])),canvas.download=fileName+".svg",canvas.click()},img.src=URL.createObjectURL(file)}});